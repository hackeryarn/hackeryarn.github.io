<!DOCTYPE html>
<html class="latte" lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="fediverse:creator" content="@hackeryarn@mastodon.social">
  
  
  
  <title>hackeryarn | You don&#x27;t need a map for that</title>
  
  <link rel="icon" type="image/svg" href="/imgs/hackeryarn.svg" />
  <link rel="stylesheet" href="/css/generated.css">
  
  <link rel="alternate" type="application/atom+xml" title="Atom Feed for https://hackeryarn.com"
    href="/atom.xml" />
  
  <script defer src="/js/main.bundle.js" data-auto-replace-svg="nest"></script>
</head>

<body hx-boost="true" hx-ext="head-support" class="flex flex-col justify-between h-screen">
  <header class="top-0 w-full z-10 flex justify-between items-center mb-7 lg:text-8xl text-4xl p-5">
  <a class="logo flex items-center no-underline lg:gap-5 gap-2 neutral-900 italianno" href="https://hackeryarn.com">
    <img class="inline lg:w-20 w-10 rounded-full" src="/imgs/hackeryarn.svg" /> hackeryarn
  </a>
  <nav class="carrois lg:text-3xl text-lg">
    <ul class="flex gap-3 lg:gap-6">
      <li>
        <a href="https://hackeryarn.com">posts</a>
      </li>
      <li>
        <a href="https://hackeryarn.com/tags">tags</a>
      </li>
      <li>
        <a href="https://hackeryarn.com/about">about</a>
      </li>
    </ul>
  </nav>
</header>
  <section class="w-full mx-auto mb-auto prose-neutral prose lg:prose-2xl px-6">
    
<article>
  <h1 class="title">
    You don&#x27;t need a map for that
  </h1>
  <p class="subtitle">Published 2024-01-01</p>
  <div>
    <p>One of the most misused data structures is the humble map; hashmap,
dictionary, hash table, etc.</p>
<p>It's a great data structure for quick storage and access of key value
pairs. Unfortunately, because of its ease and availability, it becomes
pervasive at jobs it has no business doing. The problem grows most
visible in dynamically typed languages that make the map a first class
citizen (Python, Ruby, Clojure, etc.), but it can creep up in any
language.</p>
<span id="continue-reading"></span><h2 id="passing-around-data">Passing around data</h2>
<p>This is the most common case where the map might tempt us. Let's play
out a common scenario.</p>
<p>We have a some values that we need to pass to multiple functions. We
don't want to make all these functions take 5 new arguments, so what
can we do?</p>
<p>We can stick the values in a data structure. We could put them in a
list, but keeping the order and retrieving the value at the right
location would quickly become error prone.</p>
<p>Instead, we can give each value a short name and stick it in a map. Then
each function can retrieve exactly what it needs and we don't have to
worry about order. Everything works nicely.</p>
<p>After a couple weeks, we decide to reuse one of the functions that takes
a map. But what keys did the function need from the map? That's easy
enough to figure out. We pop open the source and take a peek. We see a
couple keys used, but then the map gets passed to another function. Time
to look at the source of that function as well. We see 3 new keys here
and 1 key used in the previous function. That make 4 keys total. Great!</p>
<p>Time to... what were we doing before we started spelunking down this
call stack? Was the first key we saw <code>integration</code> or <code>integrations</code>?
And was the value of that last key a string or a boolean?</p>
<h2 id="the-problem-with-using-a-map">The problem with using a map</h2>
<p>A myriad of problems comes up as soon as we need to work with code that
relies on maps:</p>
<ul>
<li>We have to read the source to figure out the expected keys</li>
<li>We can easily make the mistake of mistyping or forgetting the name of
a key</li>
<li>We have no way to know the types of value a map expects, unless we
know ahead of time that all the values require the same type</li>
</ul>
<p>These are not problems with a map structure itself; these are problems
with how we are using the map.</p>
<h2 id="one-simple-rule">One simple rule</h2>
<p>To remedy most cases of map misuse, we can follow one simple rule. If we
know the keys of a map, we should not use a map. Instead, we should use
a struct, TypedDict, object, or any of the other abstraction that allow
us to specify the expected keys and, hopefully, value types.</p>
<p>By using these other methods of specification, we enable:</p>
<ul>
<li>Easy lookup of keys</li>
<li>Static checks of the key names and value types</li>
<li>Informative error messages if we make a mistake</li>
<li>Editor assistance with supplying the right values</li>
</ul>
<p>Just by following this rule we can save our future self from frustration
and reserve maps for what they are really meant for: storing large
numbers of key value pairs for fast lookup.</p>

  </div>
  <hr />
  <div class="not-prose -mt-10">
    

<ul class="not-prose flex gap-3">
  
  <li>
    <a href="https://hackeryarn.com/tags/discussion/"
      class="prose lg:prose-2xl underline decoration-dotted transition text-neutral-500 hover:text-neutral-900">discussion</a>
  </li>
  
  <li>
    <a href="https://hackeryarn.com/tags/development/"
      class="prose lg:prose-2xl underline decoration-dotted transition text-neutral-500 hover:text-neutral-900">development</a>
  </li>
  
</ul>


  </div>
</article>


  </section>
  <footer class="p-4 mt-15">
  <div class="flex justify-center text-4xl gap-6">
    <a href="https://mastodon.social/@hackeryarn">
      <i class="fa-brands fa-mastodon"></i>
    </a>
    <a href="https://codeberg.org/hackeryarn">
      <i class="codeberg"></i>
    </a>
    <a href="https://github.com/hackeryarn">
      <i class="fa-brands fa-github"></i>
    </a>
    <a href="https://www.linkedin.com/in/achernyak/">
      <i class="fa-brands fa-linkedin"></i>
    </a>
  </div>
  <p class="text-center text-neutral-500 mt-5">
    Copyright 2026 by Artem Chernyak
  </p>
</footer>
  <a class="hidden" rel="me" href="https://mastodon.social/@hackeryarn">Mastodon</a>
</body>

</html>